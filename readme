# AbsensiLokasi (Android) â€” Absensi Berbasis Lokasi (Radius Kantor)

Aplikasi Android (Jetpack Compose) untuk **absensi masuk/pulang berbasis lokasi** dengan validasi **radius kantor**, penyimpanan ke **Firebase Auth + Cloud Firestore**, serta tampilan **riwayat absensi**.

> Catatan: Fitur **REGISTER sudah dihapus** (sesuai kebutuhan tugas) â€” aplikasi hanya menyediakan **Login**. Akun dibuat dari Firebase Console (Auth).

---

## âœ¨ Fitur Utama

- âœ… **Login (Email/Password)** menggunakan **Firebase Authentication**
- ğŸ“ **Ambil lokasi realtime** (Fused Location Provider / Google Play Services)
- ğŸ§­ **Validasi radius kantor** (default **100 meter**) sebelum absensi bisa disimpan
- ğŸ›‘ **Deteksi Mock Location** (anti lokasi palsu) â†’ absensi ditolak jika terdeteksi
- ğŸ·ï¸ **Reverse Geocoding** â†’ simpan alamat (hasil geocoder) ke database
- ğŸ§¾ **Simpan absensi ke Firestore** (type: `IN` / `OUT`, timestamp, jarak, device, dll)
- ğŸ” **Aturan siklus absen**:
  - `IN` hanya bisa kalau status terakhir `OUT` / belum ada absen hari itu
  - `OUT` hanya bisa kalau status terakhir `IN`
  - mendukung beberapa siklus masuk (mis. masuk lagi setelah pulang)
- ğŸ§  **Auto Absen** (opsional):
  - Jika **di dalam radius kantor**, aplikasi bisa otomatis trigger `IN/OUT` sesuai status
- ğŸ—ºï¸ Tombol **Maps Kantor** & **Maps Saya** (langsung buka Google Maps)
- ğŸ‘¤ **Profil karyawan** (nama tampil bisa diedit & tersimpan ke Firestore)
- ğŸŒ— **Toggle tema**: Light / Dark / System
- ğŸ’¾ **DataStore Preferences** untuk menyimpan:
  - mode tema
  - status Auto Absen

---

## ğŸ§± Tech Stack

- **Kotlin**
- **Jetpack Compose (Material 3)**
- **Firebase**
  - Authentication (Email/Password)
  - Cloud Firestore
- **Google Play Services Location**
- **AndroidX DataStore Preferences**
- Kotlin Coroutines

---

## ğŸ—‚ï¸ Struktur Project (Ringkas)

- `app/src/main/java/com/iqra/absensi/MainActivity.kt`  
  Seluruh logic utama + UI Compose (Auth screen & Attendance screen)
- `app/src/main/AndroidManifest.xml`  
  Permission lokasi (`ACCESS_FINE_LOCATION`, `ACCESS_COARSE_LOCATION`)
- `app/google-services.json`  
  Konfigurasi Firebase (lihat catatan keamanan di bawah)

---

## ğŸ”¥ Skema Database (Firestore)

Semua data disimpan di path:

### 1) Employee Profile
`companies/{companyId}/employees/{uid}`

Field yang digunakan:
- `uid` (String)
- `name` (String)
- `email` (String)
- `createdAt` (Timestamp)
- `updatedAt` (Timestamp)

> Saat login berhasil, app akan otomatis membuat doc profile jika belum ada.

### 2) Attendance
`companies/{companyId}/attendance/{docId}`

Field yang digunakan:
- `employeeId` (String)
- `type` (String): `"IN"` / `"OUT"`
- `dateKey` (String): format `yyyy-MM-dd`
- `lat` (Double)
- `lng` (Double)
- `accuracy` (Float)
- `distance` (Double) â†’ jarak ke kantor (meter)
- `address` (String) â†’ hasil reverse geocode (opsional)
- `device` (String) â†’ model device
- `ts` (Timestamp) â†’ waktu absensi

---

## âš™ï¸ Konfigurasi Penting

Di `MainActivity.kt` terdapat konfigurasi default:

- `OFFICE_LAT` / `OFFICE_LNG` â†’ titik koordinat kantor
- `OFFICE_RADIUS_M` â†’ radius kantor (default 100m)
- `companyId` â†’ default `"cmpA"`

Silakan ubah sesuai kebutuhan.

---

## âœ… Requirement

- Android Studio (disarankan versi terbaru)
- JDK 11
- Android minSdk **24**
- Device/emulator yang mendukung Google Play Services (untuk Location)
- Firebase Project (Auth + Firestore)

---

## ğŸš€ Cara Menjalankan

1. Clone repo ini
2. Buka dengan **Android Studio**
3. Pastikan Firebase sudah siap:
   - Enable **Authentication â†’ Email/Password**
   - Buat **Cloud Firestore**
4. Pastikan file `google-services.json` ada di:
   - `app/google-services.json`
5. Sync Gradle â†’ Run

---

## ğŸ‘¤ Cara Membuat Akun (Karena Register Dihapus)

Karena aplikasi **login-only**, buat akun dari Firebase Console:

1. Firebase Console â†’ **Authentication**
2. Tab **Users** â†’ Add user
3. Masukkan email & password
4. Login pakai akun tersebut di aplikasi

---

## ğŸ” Permission yang Dipakai

- `ACCESS_FINE_LOCATION`
- `ACCESS_COARSE_LOCATION`

Aplikasi akan meminta permission saat:
- Refresh lokasi
- Melakukan absen (IN/OUT)

```md
